info:
  name: vllm
  cve: CVE-2025-65015
  summary: joserfc has Possible Uncontrolled Resource Consumption Vulnerability Triggered by Logging Arbitrarily Large JWT Token Payloads
  details: |
    The `ExceededSizeError` exception messages in `joserfc` embed non-decoded JWT token parts, which can lead to Python logging recording arbitrarily large, forged JWT payloads. This occurs when an attacker sends excessively large bearer tokens in HTTP request headers, and the application's web server does not enforce header size limits. This can impact disk, memory, and CPU on the application host, as well as external log storage and alerting services.
  cvss: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:H
  severity: CRITICAL
  security_advise: |
    1. Upgrade `joserfc` to version `1.3.5` or `1.4.2` or later.
    2. Ensure the application is deployed behind a robust web server or reverse proxy (e.g., Nginx) that explicitly caps maximum request header sizes.
    3. If using `uvicorn`/`h11`, configure `--h11-max-incomplete-event-size` to an appropriate limit, though this option restricts the total size of header *plus* body, not the header alone.
    4. Review and modify logging configurations to prevent the full JWT payload from being embedded in exception messages for `ExceededSizeError` occurrences.
references:
  - https://github.com/authlib/joserfc/security/advisories/GHSA-frfh-8v73-gjg4
  - https://nvd.nist.gov/vuln/detail/CVE-2025-65015
  - https://github.com/authlib/joserfc/commit/63932f169d924caffafa761af2122b82059017f7
  - https://github.com/authlib/joserfc/commit/673c8743fd0605b0e1de6452be6cba75f44e466b
  - https://github.com/authlib/joserfc
  - https://github.com/authlib/joserfc/releases/tag/1.3.5
  - https://github.com/authlib/joserfc/releases/tag/1.4.2
rule: (version >= "1.3.3" && version < "1.3.5") || (version >= "1.4.0" && version < "1.4.2")