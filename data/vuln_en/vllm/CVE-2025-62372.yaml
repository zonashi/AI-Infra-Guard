info:
  name: vllm
  cve: CVE-2025-62372
  summary: vLLM is vulnerable to Denial of Service (DoS) due to incorrect shape validation of multimodal embedding inputs.
  details: |
    The vLLM engine, when serving multimodal models, can be crashed by providing multimodal embedding inputs with a correct `ndim` but an incorrect `shape` (e.g., wrong hidden dimension). This vulnerability exists regardless of whether the model is intended to support such inputs. The issue arises because the input processor (`MultiModalDataParser`) only validates the `ndim` of the tensor, not its full shape. This can lead to crashes when scattering embeddings to `inputs_embeds` for supported models or during input validation for unsupported models.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
  severity: HIGH
  security_advise: |
    1. Upgrade to vllm version 0.11.1 or later.
    2. Implement API key authentication to restrict access to trusted users.
    3. Set `--limit-mm-per-prompt` to 0 for all non-text modalities to ban multimodal inputs, if multimodal functionality is not strictly required.
  references:
    - https://github.com/vllm-project/vllm/security/advisories/GHSA-pmqf-x6x8-p7qw
    - https://nvd.nist.gov/vuln/detail/CVE-2025-62372
    - https://github.com/vllm-project/vllm/pull/27204
    - https://github.com/vllm-project/vllm/pull/6613
    - https://github.com/vllm-project/vllm/commit/58fab50d82838d5014f4a14d991fdb9352c9c84b
    - https://github.com/vllm-project/vllm
rule: version >= "0.5.5" && version < "0.11.1"