info:
  name: LobeChat
  cve: CVE-2024-37895
  summary: Lobe Chat is vulnerable to an API Key leak due to improper handling of base URL modifications.
  details: |
    An attacker who can authenticate through SSO/Access Code can obtain the real backend API Key.
    This is achieved by modifying the base URL to an attacker-controlled URL on the frontend and
    setting up a server-side request. The LobeChat version allows setting the Base URL, and there
    is no outbound traffic whitelist, enabling the attacker to retrieve API Key information from
    request headers at their self-set attack address.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N
  severity: MEDIUM
  security_advise: |
    1. Upgrade LobeChat to version 0.162.25 or later.
    2. Implement outbound traffic whitelisting to restrict API key transmission to trusted domains only.
    3. Review and strengthen authentication mechanisms to prevent unauthorized base URL modifications.
rule: version > "0" && version < "0.162.25"
references:
  - https://github.com/lobehub/lobe-chat/security/advisories/GHSA-p36r-qxgx-jq2v
  - https://nvd.nist.gov/vuln/detail/CVE-2024-37895
  - https://github.com/lobehub/lobe-chat