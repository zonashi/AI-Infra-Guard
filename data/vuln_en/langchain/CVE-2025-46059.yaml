info:
  name: langchain
  cve: CVE-2025-46059
  summary: Indirect prompt injection vulnerability in Langchain's GmailToolkit.
  details: |
    The langchain-ai v0.3.51 was found to have an indirect prompt injection vulnerability within its GmailToolkit component.
    This flaw enables attackers to execute arbitrary code and compromise the application through a specially crafted email message.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. Upgrade to a patched version of langchain-ai (if available).
    2. Implement strict input validation and sanitization for all email content processed by GmailToolkit.
    3. Review and restrict permissions for the Langchain application to minimize the impact of potential compromises.
    4. Refer to the official Langchain security documentation for best practices.
rule: version < "0.3.51"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-46059
  - https://github.com/langchain-ai/langchain-community/issues/217#issuecomment-3144824471
  - https://github.com/langchain-ai/langchain/issues/30833
  - https://github.com/Jr61-star/CVEs/blob/main/CVE-2025-46059.md
  - https://python.langchain.com/docs/security