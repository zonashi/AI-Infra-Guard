info:
  name: langchain
  cve: CVE-2025-58177
  summary: Stored XSS in n8n LangChain Chat Trigger Node via initialMessages Parameter.
  details: |
    A stored Cross-Site Scripting (XSS) vulnerability exists in the `@n8n/n8n-nodes-langchain.chatTrigger` node in n8n.
    If an authorized user configures the node with malicious JavaScript in the `initialMessages` field and enables public access,
    the script will execute in the browser of anyone who visits the resulting public chat URL.
    This could lead to phishing, cookie theft, or other sensitive data exfiltration.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:N/A:N
  severity: MEDIUM
  security_advise: |
    1. Upgrade to n8n version 1.107.0 or later.
    2. As a workaround, disable the `n8n-nodes-langchain.chatTrigger` node.
  references:
    - https://github.com/n8n-io/n8n/security/advisories/GHSA-mvh4-2cm2-6hpg
    - https://nvd.nist.gov/vuln/detail/CVE-2025-58177
    - https://github.com/n8n-io/n8n/pull/18148
    - https://github.com/n8n-io/n8n/commit/d4ef191be0b39b65efa68559a3b8d5dad2e102b2
    - https://docs.n8n.io/hosting/securing/blocking-nodes
    - https://github.com/n8n-io/n8n
rule: version >= "1.24.0" && version < "1.107.0"