info:
  name: pyload-ng
  cve: CVE-2025-55156
  summary: PyLoad is vulnerable to SQL Injection via the /json/add_package API endpoint in the add_links parameter.
  details: |
    The `add_links` parameter in the `/json/add_package` API endpoint is susceptible to SQL Injection.
    The vulnerability arises because the `statuses` variable, constructed from user-supplied data,
    is directly concatenated into an SQL query without proper sanitization or parameterization.
    This allows an attacker to inject malicious SQL code, potentially leading to sensitive data leakage,
    modification, or deletion within the database.
  cvss: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:H/SC:N/SI:N/SA:N/E:P
  severity: HIGH
  security_advise: |
    1. Upgrade PyLoad to version `0.5.0b3.dev91` or later.
    2. Ensure all SQL queries use parameterized statements to prevent direct concatenation of user input.
    3. Review and sanitize all user-supplied input before using it in database operations.
rule: version > "0" && version < "0.5.0b3.dev91"
references:
  - https://github.com/pyload/pyload/security/advisories/GHSA-pwh4-6r3m-j2rf
  - https://nvd.nist.gov/vuln/detail/CVE-2025-55156
  - https://github.com/pyload/pyload/commit/134edcdf6e2a10c393743c254da3d9d90b74258f
  - https://github.com/pyload/pyload
  - https://github.com/pyload/pyload/blob/develop/src/pyload/core/database/file_database.py#L271