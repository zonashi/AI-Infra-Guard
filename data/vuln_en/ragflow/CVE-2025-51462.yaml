info:
  name: ragflow
  cve: CVE-2025-51462
  summary: Stored Cross-site Scripting (XSS) vulnerability in RAGFlow.
  details: |
    A Stored Cross-site Scripting (XSS) vulnerability exists in `api.apps.dialog_app.set_dialog` in RAGFlow version 0.17.2. Remote attackers can execute arbitrary JavaScript by providing crafted input to the assistant greeting field. This input is stored unsanitized and subsequently rendered using a markdown component with `rehype-raw`, leading to the execution of malicious scripts.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  severity: MEDIUM
  security_advise: |
    1. Upgrade RAGFlow to a version patched against this vulnerability (refer to the provided references for specific patch versions).
    2. Implement robust input sanitization for all user-supplied data, especially in fields like the assistant greeting.
    3. Configure markdown rendering components to disallow raw HTML or script execution.
  references:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-51462
    - https://github.com/infiniflow/ragflow/pull/7250
    - https://github.com/infiniflow/ragflow
    - https://www.gecko.security/blog/cve-2025-51462
rule: version == "0.17.2"