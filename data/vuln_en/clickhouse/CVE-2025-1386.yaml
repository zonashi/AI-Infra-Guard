info:
  name: clickhouse
  cve: CVE-2025-1386
  summary: Query smuggling vulnerability in ch-go library.
  details: |
    When using the ch-go library, under specific conditions where the query includes a large, uncompressed malicious external data,
    an attacker in control of such data can smuggle another query packet into the connection stream.
  cvss: CVSS:4.0/AV:N/AC:H/AT:N/PR:H/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
  severity: MEDIUM
  security_advise: |
    1. Upgrade to ch-go library version 0.65.0 or later.
  references:
    - https://github.com/ClickHouse/ch-go/security/advisories/GHSA-m454-3xv7-qj85
    - https://nvd.nist.gov/vuln/detail/CVE-2025-1386
    - https://github.com/ClickHouse/ch-go/commit/0e835663df32b09b828528c07a5507686e6d975e
    - https://github.com/ClickHouse/ch-go
    - https://pkg.go.dev/vuln/GO-2025-3603
rule: version > "0" && version < "0.65.0"