info:
  name: LiteLLM
  cve: CVE-2024-9606
  summary: LiteLLM reveals a portion of the API key in logging files due to insufficient masking.
  details: |
    In berriai/litellm before version 1.44.12, the `litellm/litellm_core_utils/litellm_logging.py` file contains a vulnerability where the API key masking code only masks the first 5 characters of the key. This results in the leakage of almost the entire API key in the logs, exposing a significant amount of the secret key. The issue affects version v1.44.9.
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade LiteLLM to version 1.44.12 or later.
    2. Review and rotate any API keys that may have been exposed in logs.
    3. Ensure proper log sanitization and access controls are in place for logging systems.
rule: version < "1.44.12"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-9606
  - https://github.com/berriai/litellm/commit/9094071c4782183e84f10630e2450be3db55509a
  - https://github.com/BerriAI/litellm
  - https://huntr.com/bounties/4a03796f-a8d4-4293-84ef-d3959456223a