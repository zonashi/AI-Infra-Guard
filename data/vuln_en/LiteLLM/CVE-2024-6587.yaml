info:
  name: LiteLLM
  cve: CVE-2024-6587
  summary: LiteLLM Server-Side Request Forgery (SSRF) vulnerability allows API key exfiltration.
  details: |
    A Server-Side Request Forgery (SSRF) vulnerability exists in berriai/litellm version 1.38.10.
    This vulnerability allows users to specify the `api_base` parameter when making requests to
    `POST /chat/completions`, causing the application to send the request to the domain specified
    by `api_base`. This request includes the OpenAI API key. A malicious user can set the `api_base`
    to their own domain and intercept the OpenAI API key, leading to unauthorized access and
    potential misuse of the API key.
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade LiteLLM to version 1.44.8 or later.
    2. Implement strict input validation for the `api_base` parameter to prevent arbitrary URL submissions.
    3. Consider network-level restrictions to prevent outbound connections to untrusted domains from the LiteLLM application.
rule: version > "0" && version < "1.44.8"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-6587
  - https://github.com/berriai/litellm/commit/ba1912afd1b19e38d3704bb156adf887f91ae1e0
  - https://github.com/berriai/litellm
  - https://huntr.com/bounties/4001e1a2-7b7a-4776-a3ae-e6692ec3d997