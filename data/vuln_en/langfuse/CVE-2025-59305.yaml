info:
  name: langfuse
  cve: CVE-2025-59305
  summary: Improper authorization in Langfuse background migration endpoints allows authenticated users to invoke control functions.
  details: |
    The vulnerability in Langfuse 3.1 before d67b317 stems from improper authorization in its background migration endpoints.
    Any authenticated user can invoke migration control functions, potentially leading to data corruption or denial of service
    through unauthorized access to TRPC endpoints like `backgroundMigrations.all`, `backgroundMigrations.status`, and `backgroundMigrations.retry`.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L
  severity: HIGH
  security_advise: |
    1. Upgrade Langfuse to version d67b317 or later.
    2. Implement strict authorization checks for all background migration control functions.
    3. Review and restrict access to TRPC endpoints related to background migrations.
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-59305
  - https://github.com/langfuse/langfuse/pull/9028
  - https://depthfirst.com/post/how-an-authorization-flaw-reveals-a-common-security-blind-spot-cve-2025-59305-case-study
  - https://depthfirst.webflow.io/post/how-an-authorization-flaw-reveals-a-common-security-blind-spot-cve-2025-59305-case-study
rule: version < "3.1.0" # Assuming d67b317 is a patch or specific commit after 3.1.0, or 3.1.0 itself is vulnerable. Adjust if a specific version number is available.