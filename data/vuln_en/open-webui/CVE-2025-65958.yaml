info:
  name: open-webui
  cve: CVE-2025-65958
  summary: Open WebUI is vulnerable to Server-Side Request Forgery (SSRF) via arbitrary URL processing in the /api/v1/retrieval/process/web endpoint.
  details: |
    A Server-Side Request Forgery (SSRF) vulnerability in Open WebUI allows any authenticated user to force the server to make HTTP requests to arbitrary URLs. This can be exploited to access cloud metadata endpoints (AWS/GCP/Azure), scan internal networks, access internal services behind firewalls, and exfiltrate sensitive information. No special permissions beyond basic authentication are required.
    The vulnerability exists in the `/api/v1/retrieval/process/web` endpoint located in `backend/open_webui/routers/retrieval.py` at lines 1758-1767. The `form_data.url` parameter is passed directly to `get_content_from_url()` without any validation. This function chain ultimately calls web loaders that fetch arbitrary URLs. No validation is performed for private IP ranges, localhost addresses, cloud metadata endpoints, protocol restrictions, or domain allowlisting.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade to Open WebUI version 0.6.37 or later.
    2. Implement strict URL validation and sanitization for all user-supplied URLs, especially in the `/api/v1/retrieval/process/web` endpoint.
    3. Restrict outbound connections from the server to only necessary and whitelisted domains/IPs.
    4. Consider implementing a proxy or a dedicated service for fetching external content to further isolate the main application from potential SSRF attacks.
rule: version > "0" && version < "0.6.37"
references:
  - https://github.com/open-webui/open-webui/security/advisories/GHSA-c6xv-rcvw-v685
  - https://nvd.nist.gov/vuln/detail/CVE-2025-65958
  - https://github.com/open-webui/open-webui/commit/02238d3113e966c353fce18f1b65117380896774
  - https://github.com/open-webui/open-webui