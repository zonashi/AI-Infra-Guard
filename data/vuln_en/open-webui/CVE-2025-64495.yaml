info:
  name: open-webui
  cve: CVE-2025-64495
  summary: Open WebUI vulnerable to Stored DOM XSS via prompts when 'Insert Prompt as Rich Text' is enabled resulting in ATO/RCE.
  details: |
    The functionality that inserts custom prompts into the chat window is vulnerable to DOM XSS when 'Insert Prompt as Rich Text' is enabled. This occurs because the prompt body is assigned to the DOM sink `.innerHtml` without sanitization. An attacker with permissions to create prompts can plant a payload that could be triggered by other users if they run the corresponding `/` command to insert the prompt. This can lead to account compromise via session token exfiltration, and for admin users, potentially remote code execution (RCE) by forcing them to run malicious Python functions.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N
  severity: HIGH
  security_advise: |
    1. Sanitise the user controlled HTML with DOMPurify before assigning it to `.innerHtml`.
    2. Upgrade to a version greater than or equal to 0.6.35.
rule: version > "0" && version < "0.6.35"
references:
  - https://github.com/open-webui/open-webui/security/advisories/GHSA-w7xj-8fx7-wfch
  - https://nvd.nist.gov/vuln/detail/CVE-2025-64495
  - https://github.com/open-webui/open-webui/commit/eb9c4c0e358c274aea35f21c2856c0a20051e5f1
  - https://github.com/open-webui/open-webui
  - https://github.com/open-webui/open-webui/blob/7a83e7dfa367d19f762ec17cac5e4a94ea2bd97d/src/lib/components/common/RichTextInput.svelte#L348