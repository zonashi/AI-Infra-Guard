info:
  name: open-webui
  cve: CVE-2025-65959
  summary: Open WebUI is vulnerable to Stored DOM XSS via the Note 'Download PDF' functionality.
  details: |
    A Stored XSS vulnerability exists in Open-WebUI's Notes PDF download feature.
    Attackers can import a Markdown file containing malicious SVG tags into Notes,
    leading to arbitrary JavaScript code execution and session token theft when a victim
    downloads the note as a PDF. This can be exploited by any authenticated user,
    and unauthenticated external attackers can steal session tokens by sharing specially
    crafted markdown files. The vulnerability stems from incomplete TipTap Editor
    configuration (missing schema definition for dangerous tags) and a lack of sanitization
    during PDF generation, where `note.data.content.html` is directly assigned to `innerHTML`
    without DOMPurify or other sanitization.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade Open-WebUI to version `0.6.37` or later.
    2. Implement robust input sanitization using libraries like DOMPurify when handling user-provided HTML content, especially before assigning it to `innerHTML`.
    3. Ensure that the TipTap editor configuration explicitly defines and sanitizes or forbids dangerous tags like SVG and Script.
rule: version > "0" && version < "0.6.37"
references:
  - https://github.com/open-webui/open-webui/security/advisories/GHSA-8wvc-869r-xfqf
  - https://nvd.nist.gov/vuln/detail/CVE-2025-65959
  - https://github.com/open-webui/open-webui/commit/03cc6ce8eb5c055115406e2304fbf7e3338b8dce
  - https://github.com/open-webui/open-webui
  - https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html
  - https://github.com/cure53/DOMPurify