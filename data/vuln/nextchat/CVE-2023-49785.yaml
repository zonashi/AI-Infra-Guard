info:
  name: nextchat
  cve: CVE-2023-49785
  summary: NextChat 的 /api/cors 端点存在完全读取的 SSRF 和 XSS 漏洞。
  details: |
    NextChat (ChatGPT-Next-Web) 2.11.2 及更早版本容易受到服务器端请求伪造 (SSRF) 和跨站脚本 (XSS) 漏洞的影响。这使得攻击者能够获得对内部 HTTP 端点的读取访问权限，并可能使用各种 HTTP 方法获得写入访问权限。攻击者还可以利用此漏洞通过这些开放代理转发恶意流量来掩盖其源 IP。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
  severity: CRITICAL
  security_advise: |
    1. 避免将应用程序暴露在公共互联网上。
    2. 如果将应用程序暴露在互联网上，请确保其部署在隔离网络中，并且无法访问任何其他内部资源。
    3. 监控开发人员发布的官方补丁或更新。
rule: version > "0" && version <= "2.11.2"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-49785
  - https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web
  - https://www.horizon3.ai/attack-research/attack-blogs/nextchat-an-ai-chatbot-that-lets-you-talk-to-anyone-you-want-to