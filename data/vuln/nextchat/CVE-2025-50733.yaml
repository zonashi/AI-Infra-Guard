info:
  name: nextchat
  cve: CVE-2025-50733
  summary: NextChat 存在跨站脚本 (XSS) 漏洞，原因是 AI 生成的 HTML 内容未经过适当净化。
  details: |
    NextChat 在 artifacts.tsx 的 HTMLPreview 组件中包含一个跨站脚本 (XSS) 漏洞。
    攻击者可以通过精心制作提示，使 AI 生成恶意 HTML/JavaScript 代码来利用此漏洞。
    当用户查看 HTML 预览时，注入的 JavaScript 会在其浏览器上下文中执行，可能导致 API 密钥泄露、未经授权的操作和会话劫持。
    此漏洞的产生是由于来自 AI 响应的用户影响的 HTML 在具有“allow-scripts”沙箱权限的 iframe 中呈现，而未经过适当净化。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  severity: MEDIUM
  security_advise: |
    1. 在 HTMLPreview 组件中渲染所有 AI 生成的内容之前，实施强大的 HTML 净化。
    2. 考虑对渲染不受信任内容的 iframe 采取更严格的沙箱策略，在非绝对必要的情况下禁止脚本执行。
    3. 教育用户了解与不受信任或可疑的 AI 生成内容交互的风险。
rule: ""
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-50733
  - https://github.com/fai1424/Vulnerability-Research/blob/main/CVE-2025-50733/README.md
  - https://hackmd.io/@fai1424/BkgqMnNxgl