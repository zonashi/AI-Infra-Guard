info:
  name: LobeChat
  cve: CVE-2024-37895
  summary: 由于对基本 URL 修改处理不当，Lobe Chat 存在 API 密钥泄露漏洞。
  details: |
    能够通过 SSO/访问代码进行身份验证的攻击者可以获取真实的后端 API 密钥。
    这是通过在前端将基本 URL 修改为攻击者控制的 URL 并设置服务器端请求来实现的。
    LobeChat 版本允许设置基本 URL，并且没有出站流量白名单，这使得攻击者能够从
    其自行设置的攻击地址的请求头中检索 API 密钥信息。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N
  severity: MEDIUM
  security_advise: |
    1. 将 LobeChat 升级到 0.162.25 或更高版本。
    2. 实施出站流量白名单，将 API 密钥传输限制到仅受信任的域。
    3. 审查并加强身份验证机制，以防止未经授权的基本 URL 修改。
rule: version > "0" && version < "0.162.25"
references:
  - https://github.com/lobehub/lobe-chat/security/advisories/GHSA-p36r-qxgx-jq2v
  - https://nvd.nist.gov/vuln/detail/CVE-2024-37895
  - https://github.com/lobehub/lobe-chat