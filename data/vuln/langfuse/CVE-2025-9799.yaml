info:
  name: langfuse
  cve: CVE-2025-9799
  summary: Langfuse 通过 promptChangeEventSourcing 函数容易受到服务器端请求伪造 (SSRF) 攻击。
  details: |
    在 Langfuse 3.88.0 版本之前发现了一个安全漏洞。该漏洞存在于 `web/src/features/prompts/server/routers/promptRouter.ts` 文件中的 `promptChangeEventSourcing` 函数中，该文件是 Webhook 处理程序组件的一部分。此缺陷可被利用来执行服务器端请求伪造 (SSRF)，允许攻击者从服务器发起未经授权的请求。攻击可以远程发起，但由于其高度复杂性，利用被认为是困难的。
  cvss: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L
  severity: LOW
  security_advise: |
    1. 将 Langfuse 升级到 3.88.0 以上的版本。
    2. 审查并对所有用户提供的 URL 或用于服务器端请求的参数实施严格的输入验证和清理。
    3. 考虑为服务器发出的传出请求实施允许域或 IP 地址的白名单。
rule: version < "3.88.0"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-9799
  - https://github.com/langfuse/langfuse/issues/8522
  - https://github.com/langfuse/langfuse/issues/8522#issue-3320549867
  - https://vuldb.com/?ctiid.322114
  - https://vuldb.com/?id.322114
  - https://vuldb.com/?submit.641128