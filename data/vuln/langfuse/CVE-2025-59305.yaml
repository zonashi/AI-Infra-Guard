info:
  name: langfuse
  cve: CVE-2025-59305
  summary: Langfuse 后台迁移端点中不当授权允许已认证用户调用控制功能。
  details: |
    Langfuse 3.1 版本在 d67b317 之前的漏洞源于其后台迁移端点中的不当授权。
    任何已认证用户都可以调用迁移控制功能，这可能通过未经授权访问 TRPC 端点（如 `backgroundMigrations.all`、`backgroundMigrations.status` 和 `backgroundMigrations.retry`）
    导致数据损坏或拒绝服务。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L
  severity: HIGH
  security_advise: |
    1. 将 Langfuse 升级到 d67b317 或更高版本。
    2. 对所有后台迁移控制功能实施严格的授权检查。
    3. 审查并限制对与后台迁移相关的 TRPC 端点的访问。
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-59305
  - https://github.com/langfuse/langfuse/pull/9028
  - https://depthfirst.com/post/how-an-authorization-flaw-reveals-a-common-security-blind-spot-cve-2025-59305-case-study
  - https://depthfirst.webflow.io/post/how-an-authorization-flaw-reveals-a-common-security-blind-spot-cve-2025-59305-case-study
rule: version < "3.1.0" # Assuming d67b317 is a patch or specific commit after 3.1.0, or 3.1.0 itself is vulnerable. Adjust if a specific version number is available.