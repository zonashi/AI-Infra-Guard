info:
  name: langfuse
  cve: CVE-2025-0330
  summary: 由于解析团队设置时出错，LiteLLM 泄露 Langfuse API 密钥。
  details: |
    在 berriai/litellm v1.52.1 版本中，proxy_server.py 文件中的一个问题导致在解析团队设置时发生错误，从而泄露 Langfuse API 密钥。此漏洞暴露了敏感信息，包括 langfuse_secret 和 langfuse_public_key，这些信息可以提供对存储所有请求的 Langfuse 项目的完全访问权限。
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. 将 LiteLLM 升级到 1.52.1 以上的版本。
    2. 审查并更新 `proxy_server.py` 中的错误处理机制，以防止敏感信息泄露。
    3. 如果 Langfuse API 密钥已暴露，请轮换它们。
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-0330
  - https://github.com/BerriAI/litellm
  - https://huntr.com/bounties/661b388a-44d8-4ad5-862b-4dc5b80be30a
rule: version > "0" && version <= "1.52.1"