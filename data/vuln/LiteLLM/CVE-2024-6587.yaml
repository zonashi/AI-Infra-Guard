info:
  name: LiteLLM
  cve: CVE-2024-6587
  summary: LiteLLM 服务端请求伪造 (SSRF) 漏洞允许 API 密钥泄露。
  details: |
    berriai/litellm 1.38.10 版本中存在一个服务端请求伪造 (SSRF) 漏洞。
    此漏洞允许用户在向 `POST /chat/completions` 发出请求时指定 `api_base` 参数，
    导致应用程序将请求发送到 `api_base` 指定的域。此请求包含 OpenAI API 密钥。
    恶意用户可以将 `api_base` 设置为他们自己的域并拦截 OpenAI API 密钥，
    从而导致未经授权的访问和 API 密钥的潜在滥用。
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. 将 LiteLLM 升级到 1.44.8 或更高版本。
    2. 对 `api_base` 参数实施严格的输入验证，以防止任意 URL 提交。
    3. 考虑实施网络级别限制，以防止 LiteLLM 应用程序向不受信任的域进行出站连接。
rule: version > "0" && version < "1.44.8"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-6587
  - https://github.com/berriai/litellm/commit/ba1912afd1b19e38d3704bb156adf887f91ae1e0
  - https://github.com/berriai/litellm
  - https://huntr.com/bounties/4001e1a2-7b7a-4776-a3ae-e6692ec3d997