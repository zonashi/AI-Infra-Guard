info:
  name: LiteLLM
  cve: CVE-2024-6825
  summary: LiteLLM 由于对 'post_call_rules' 配置处理不当，存在远程代码执行 (RCE) 漏洞。
  details: |
    BerriAI/litellm 版本 1.40.12 包含一个允许远程代码执行的漏洞。
    该问题存在于 'post_call_rules' 配置的处理中，其中可以添加回调函数。
    提供的值在最后一个 '.' 标记处分割，最后一部分被视为函数名，其余部分附加 '.py' 扩展名并导入。
    这允许攻击者将系统方法（例如 'os.system'）设置为回调，从而在处理聊天响应时执行任意命令。
  cvss: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  severity: HIGH
  security_advise: |
    1. 将 LiteLLM 升级到 1.40.12 以上解决此漏洞的版本。
    2. 审查并清理 'post_call_rules' 配置中使用的所有输入，以防止任意代码执行。
    3. 对回调函数名和模块实施严格验证，以确保只执行受信任的函数。
rule: version > "1.40.3.dev2" && version <= "1.40.12"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-6825
  - https://github.com/berriai/litellm/commit/441c7275ed2715f47650a7c2e525055c804073a9
  - https://github.com/BerriAI/litellm
  - https://github.com/BerriAI/litellm/blob/056913fd7049923a106130b02d7c29e7f312beec/litellm/utils.py#L2818
  - https://huntr.com/bounties/1d98bebb-6cf4-46c9-87c3-d3b1972973b5