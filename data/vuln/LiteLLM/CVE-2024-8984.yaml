info:
  name: LiteLLM
  cve: CVE-2024-8984
  summary: LiteLLM 易受通过精心构造的 HTTP 请求发起的拒绝服务 (DoS) 攻击。
  details: |
    berriai/litellm v1.44.5 版本存在拒绝服务 (DoS) 漏洞。
    此漏洞可通过在 HTTP 请求中多部分边界的末尾附加字符（例如破折号 (-)）来利用。
    服务器会持续处理每个字符，导致资源过度消耗，从而使服务不可用。
    此问题无需身份验证，也不需要任何用户交互，影响服务的所有用户。
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
  severity: HIGH
  security_advise: |
    1. 将 LiteLLM 升级到 1.56.2 或更高版本。
    2. 对 HTTP 请求中的多部分边界实施严格的输入验证。
    3. 监控服务器资源利用率，以发现可能表明 DoS 攻击的异常峰值。
rule: version > "0" && version < "1.56.2"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-8984
  - https://github.com/BerriAI/litellm/commit/4f49f836aa844ac9b6bfbeff27e6f6b2b9cf3f61
  - https://github.com/BerriAI/litellm
  - https://github.com/BerriAI/litellm/blob/8c5ff150f6142608ffe968e4e68429f978fda187/litellm/tests/test_spend_logs.py#L242
  - https://huntr.com/bounties/554fc76b-3097-4223-b4cf-110b853e9355