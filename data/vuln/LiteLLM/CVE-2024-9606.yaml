info:
  name: LiteLLM
  cve: CVE-2024-9606
  summary: LiteLLM 由于掩码不足，在日志文件中泄露部分 API 密钥。
  details: |
    在 berriai/litellm 1.44.12 版本之前，`litellm/litellm_core_utils/litellm_logging.py` 文件中存在一个漏洞，其 API 密钥掩码代码仅掩盖密钥的前 5 个字符。这导致几乎整个 API 密钥在日志中泄露，暴露了大量的秘密密钥。此问题影响 v1.44.9 版本。
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. 将 LiteLLM 升级到 1.44.12 或更高版本。
    2. 审查并轮换任何可能已在日志中暴露的 API 密钥。
    3. 确保日志系统已实施适当的日志清理和访问控制。
rule: version < "1.44.12"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-9606
  - https://github.com/berriai/litellm/commit/9094071c4782183e84f10630e2450be3db55509a
  - https://github.com/BerriAI/litellm
  - https://huntr.com/bounties/4a03796f-a8d4-4293-84ef-d3959456223a