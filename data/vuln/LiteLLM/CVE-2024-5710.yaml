info:
  name: LiteLLM
  cve: CVE-2024-5710
  summary: LiteLLM 在团队管理中存在不当访问控制漏洞。
  details: |
    berriai/litellm 1.34.34 版本在团队管理功能中存在不当访问控制漏洞。
    此漏洞允许攻击者执行未经授权的操作，例如创建、更新、查看、删除、
    阻止和解除阻止任何团队，以及向任何团队添加或删除任何成员。
    该漏洞源于各种团队管理端点中访问控制检查不足，
    使攻击者能够在未经适当授权的情况下利用这些功能。
  cvss: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N
  severity: MEDIUM
  security_advise: |
    1. 升级到 LiteLLM 1.40.15 或更高版本。
    2. 对所有团队管理端点实施严格的访问控制检查。
    3. 确保所有团队相关操作都需要适当的授权。
rule: version > "0" && version < "1.40.15"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-5710
  - https://github.com/BerriAI/litellm/commit/da3ae00bd68f451ed8ddf0bc0a9fd34bde5554d6
  - https://github.com/BerriAI/litellm/blob/224148d6133ee50801cb129cbd213992e25/litellm/proxy/auth/user_api_key_auth.py#L1020
  - https://github.com/berriai/litellm
  - https://huntr.com/bounties/70897f59-a966-4d93-b71e-745e3da91970