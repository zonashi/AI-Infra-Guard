info:
  name: LiteLLM
  cve: CVE-2024-5225
  summary: LiteLLM 的 `/global/spend/logs` 端点存在 SQL 注入漏洞。
  details: |
    berriai/litellm 仓库中存在一个 SQL 注入漏洞，具体位于 `/global/spend/logs` 端点。该漏洞是由于未能正确处理 SQL 命令中使用的特殊元素而导致的。受影响的代码通过将未经验证的 `api_key` 参数直接拼接到查询中来构造 SQL 查询，如果 `api_key` 包含恶意数据，则容易受到 SQL 注入攻击。成功利用此漏洞可能导致未经授权的访问、数据操纵、机密信息泄露以及拒绝服务 (DoS)。
  cvss: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
  severity: MEDIUM
  security_advise: |
    1. 将 LiteLLM 升级到 1.40.0 或更高版本。
    2. 确保所有用户提供的输入，特别是 API 密钥，在用于 SQL 查询之前都经过适当的清理和验证。
    3. 实施参数化查询或预处理语句以防止 SQL 注入。
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-5225
  - https://github.com/BerriAI/litellm/pull/3940
  - https://github.com/BerriAI/litellm/commit/f75c15d6cd535aa78014378ad532de1df6be2f56
  - https://github.com/BerriAI/litellm
  - https://huntr.com/bounties/491e4884-0306-4cd4-8fe2-9a19de33bf5c
rule: version < "1.40.0"