info:
  name: LiteLLM
  cve: CVE-2024-4890
  summary: LiteLLM 的 '/team/update' 进程中存在 SQL 注入漏洞。
  details: |
    berriai/litellm 应用程序中存在一个盲 SQL 注入漏洞，具体位于 '/team/update' 进程中。
    该漏洞是由于用于删除用户的原始 SQL 查询中对 'user_id' 参数处理不当而引起的。
    攻击者可以通过 'user_id' 参数注入恶意 SQL 命令来利用此漏洞，从而可能导致
    未经授权访问数据库中存储的敏感信息，例如 API 密钥、用户信息和令牌。
    受影响的版本是 1.27.14。
  cvss: CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. 升级到 litellm 的已修补版本。
    2. 实施适当的输入验证和参数化查询以防止 SQL 注入。
    3. 在数据库查询中使用所有用户提供的输入之前，对其进行审查和清理。
rule: version <= "1.27.14"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-4890
  - https://github.com/BerriAI/litellm/pull/2954
  - https://github.com/BerriAI/litellm
  - https://huntr.com/bounties/a4f6d357-5b44-4e00-9cac-f1cc351211d2