info:
  name: LiteLLM
  cve: CVE-2024-4888
  summary: LiteLLM 中因不当输入验证导致任意文件删除。
  details: |
    BerriAI 的 litellm 最新版本中，由于对 `/audio/transcriptions` 端点输入验证不当，存在任意文件删除漏洞。攻击者可以通过发送包含文件路径的特制请求来利用此漏洞，服务器随后会在没有适当授权或验证的情况下删除指定文件。此漏洞存在于使用 `os.remove(file.filename)` 删除文件的代码中，允许任何用户删除服务器上的关键文件，例如 SSH 密钥、SQLite 数据库或配置文件。
  cvss: CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:H
  severity: HIGH
  security_advise: |
    1. 将 LiteLLM 升级到版本 1.35.36 或更高版本。
    2. 对 `/audio/transcriptions` 端点上的文件路径实施严格的输入验证。
    3. 确保在删除文件之前进行适当的授权检查。
rule: version < "1.35.36"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-4888
  - https://github.com/BerriAI/litellm/pull/3193
  - https://github.com/BerriAI/litellm
  - https://huntr.com/bounties/48461d89-cf13-4ad3-a43e-0d37da08fc6c