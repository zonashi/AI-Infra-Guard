info:
  name: open-webui
  cve: CVE-2025-64496
  summary: Open WebUI 在启用直接连接时，易受来自外部模型服务器的服务器发送事件 (SSE) 的代码注入攻击。
  details: |
    Open WebUI 0.6.33 及更早版本在“直接连接”功能中存在代码注入漏洞。恶意外部模型服务器可以通过服务器发送事件 (SSE) `execute` 事件在受害者浏览器中执行任意 JavaScript。这可能导致认证令牌被盗、账户完全被接管，并且当与 Functions API 结合使用时，能够在后端服务器上实现远程代码执行。攻击要求受害者启用“直接连接”（默认禁用）并添加攻击者的恶意模型 URL，这可以通过社会工程实现。该漏洞源于前端 JavaScript 代码在没有适当验证的情况下处理 SSE 事件，特别是处理触发使用 `new Function(event.data.code)` 执行任意 JavaScript 的 `execute` 事件类型。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N
  severity: HIGH
  security_advise: |
    1. 将 Open WebUI 升级到 0.6.35 或更高版本。
    2. 避免从不受信任的来源启用“直接连接”。
    3. 添加外部模型 URL 时要谨慎，特别是通过社会工程获得的 URL。
    4. 实施严格的内容安全策略 (CSP) 以缓解任意 JavaScript 执行。
rule: version > "0" && version < "0.6.35"
references:
  - https://github.com/open-webui/open-webui/security/advisories/GHSA-cm35-v4vp-5xvx
  - https://nvd.nist.gov/vuln/detail/CVE-2025-64496
  - https://github.com/open-webui/open-webui/commit/8af6a4cf21b756a66cd58378a01c60f74c39b7ca
  - https://github.com/open-webui/open-webui