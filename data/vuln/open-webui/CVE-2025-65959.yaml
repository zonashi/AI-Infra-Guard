info:
  name: open-webui
  cve: CVE-2025-65959
  summary: Open WebUI 存在存储型 DOM XSS 漏洞，通过笔记中的“下载 PDF”功能进行利用。
  details: |
    Open-WebUI 的笔记 PDF 下载功能存在存储型 XSS 漏洞。攻击者可以将包含恶意 SVG 标签的 Markdown 文件导入到笔记中，
    当受害者将笔记下载为 PDF 时，可能导致任意 JavaScript 代码执行和会话令牌被盗。
    任何已认证用户都可以利用此漏洞，未经认证的外部攻击者可以通过共享特制 Markdown 文件窃取会话令牌。
    该漏洞源于 TipTap 编辑器配置不完整（缺少危险标签的 schema 定义）以及 PDF 生成过程中缺乏清理，
    其中 `note.data.content.html` 直接赋值给 `innerHTML` 而没有经过 DOMPurify 或其他清理。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N
  severity: HIGH
  security_advise: |
    1. 将 Open-WebUI 升级到 `0.6.37` 或更高版本。
    2. 在处理用户提供的 HTML 内容时，尤其是在将其赋值给 `innerHTML` 之前，使用 DOMPurify 等库实施健壮的输入清理。
    3. 确保 TipTap 编辑器配置明确定义并清理或禁止 SVG 和 Script 等危险标签。
rule: version > "0" && version < "0.6.37"
references:
  - https://github.com/open-webui/open-webui/security/advisories/GHSA-8wvc-869r-xfqf
  - https://nvd.nist.gov/vuln/detail/CVE-2025-65959
  - https://github.com/open-webui/open-webui/commit/03cc6ce8eb5c055115406e2304fbf7e3338b8dce
  - https://github.com/open-webui/open-webui
  - https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html
  - https://github.com/cure53/DOMPurify