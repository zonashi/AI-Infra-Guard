info:
  name: open-webui
  cve: CVE-2025-65958
  summary: Open WebUI 存在服务器端请求伪造 (SSRF) 漏洞，通过 /api/v1/retrieval/process/web 端点中的任意 URL 处理实现。
  details: |
    Open WebUI 中存在一个服务器端请求伪造 (SSRF) 漏洞，允许任何经过身份验证的用户强制服务器向任意 URL 发出 HTTP 请求。这可被利用来访问云元数据端点 (AWS/GCP/Azure)、扫描内部网络、访问防火墙后的内部服务以及窃取敏感信息。除了基本身份验证之外，不需要任何特殊权限。
    该漏洞存在于 `backend/open_webui/routers/retrieval.py` 文件中第 1758-1767 行的 `/api/v1/retrieval/process/web` 端点。`form_data.url` 参数直接传递给 `get_content_from_url()`，没有任何验证。此函数链最终调用获取任意 URL 的 Web 加载器。未对私有 IP 范围、本地主机地址、云元数据端点、协议限制或域白名单执行任何验证。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N
  severity: HIGH
  security_advise: |
    1. 升级到 Open WebUI 0.6.37 或更高版本。
    2. 对所有用户提供的 URL，特别是在 `/api/v1/retrieval/process/web` 端点中，实施严格的 URL 验证和清理。
    3. 限制服务器的出站连接，仅允许必要的和列入白名单的域/IP。
    4. 考虑实施代理或专用服务来获取外部内容，以进一步隔离主应用程序免受潜在的 SSRF 攻击。
rule: version > "0" && version < "0.6.37"
references:
  - https://github.com/open-webui/open-webui/security/advisories/GHSA-c6xv-rcvw-v685
  - https://nvd.nist.gov/vuln/detail/CVE-2025-65958
  - https://github.com/open-webui/open-webui/commit/02238d3113e966c353fce18f1b65117380896774
  - https://github.com/open-webui/open-webui