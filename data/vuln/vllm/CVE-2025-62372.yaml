info:
  name: vllm
  cve: CVE-2025-62372
  summary: 由于多模态嵌入输入的形状验证不正确，vLLM 容易受到拒绝服务 (DoS) 攻击。
  details: |
    vLLM 引擎在提供多模态模型时，可以通过提供具有正确 `ndim` 但不正确 `shape`（例如，错误的隐藏维度）的多模态嵌入输入而导致崩溃。无论模型是否旨在支持此类输入，此漏洞都存在。问题出现的原因是输入处理器 (`MultiModalDataParser`) 只验证张量的 `ndim`，而不是其完整形状。这可能导致在将嵌入分散到支持模型的 `inputs_embeds` 时或在不支持模型的输入验证期间发生崩溃。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
  severity: HIGH
  security_advise: |
    1. 升级到 vllm 0.11.1 或更高版本。
    2. 实施 API 密钥认证以限制受信任用户的访问。
    3. 如果不需要多模态功能，请将所有非文本模态的 `--limit-mm-per-prompt` 设置为 0 以禁止多模态输入。
  references:
    - https://github.com/vllm-project/vllm/security/advisories/GHSA-pmqf-x6x8-p7qw
    - https://nvd.nist.gov/vuln/detail/CVE-2025-62372
    - https://github.com/vllm-project/vllm/pull/27204
    - https://github.com/vllm-project/vllm/pull/6613
    - https://github.com/vllm-project/vllm/commit/58fab50d82838d5014f4a14d991fdb9352c9c84b
    - https://github.com/vllm-project/vllm
rule: version >= "0.5.5" && version < "0.11.1"