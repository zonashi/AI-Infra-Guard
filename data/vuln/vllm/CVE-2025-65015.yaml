info:
  name: vllm
  cve: CVE-2025-65015
  summary: joserfc 存在因记录任意大的 JWT 令牌负载而触发的潜在不受控制的资源消耗漏洞
  details: |
    `joserfc` 中的 `ExceededSizeError` 异常消息会嵌入未解码的 JWT 令牌部分，这可能导致 Python 日志记录任意大的伪造 JWT 负载。当攻击者在 HTTP 请求头中发送过大的 bearer 令牌，并且应用程序的 Web 服务器未强制执行头大小限制时，就会发生这种情况。这可能会影响应用程序主机上的磁盘、内存和 CPU，以及外部日志存储和警报服务。
  cvss: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:H
  severity: CRITICAL
  security_advise: |
    1. 将 `joserfc` 升级到版本 `1.3.5` 或 `1.4.2` 或更高版本。
    2. 确保应用程序部署在明确限制最大请求头大小的强大 Web 服务器或反向代理（例如 Nginx）之后。
    3. 如果使用 `uvicorn`/`h11`，请将 `--h11-max-incomplete-event-size` 配置为适当的限制，尽管此选项限制的是头 *加* 主体的总大小，而不是仅限头的大小。
    4. 审查并修改日志配置，以防止在发生 `ExceededSizeError` 时将完整的 JWT 负载嵌入到异常消息中。
references:
  - https://github.com/authlib/joserfc/security/advisories/GHSA-frfh-8v73-gjg4
  - https://nvd.nist.gov/vuln/detail/CVE-2025-65015
  - https://github.com/authlib/joserfc/commit/63932f169d924caffafa761af2122b82059017f7
  - https://github.com/authlib/joserfc/commit/673c8743fd0605b0e1de6452be6cba75f44e466b
  - https://github.com/authlib/joserfc
  - https://github.com/authlib/joserfc/releases/tag/1.3.5
  - https://github.com/authlib/joserfc/releases/tag/1.4.2
rule: (version >= "1.3.3" && version < "1.3.5") || (version >= "1.4.0" && version < "1.4.2")