info:
  name: vllm
  cve: CVE-2025-32381
  summary: vllm 因内存中存在无界缓存而容易受到拒绝服务 (DoS) 攻击。
  details: |
    vllm 使用的 xgrammar 库包含一个用于编译语法的无界缓存。
    此缓存在内存中，攻击者可以利用它来填满主机的内存，
    从而导致拒绝服务。例如，通过向 LLM 推理服务器发送许多具有唯一 JSON 模式的小请求，就可能发生这种情况。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
  severity: HIGH
  security_advise: |
    1. 将 xgrammar 升级到 0.1.18 或更高版本。
    2. 确保任何使用 xgrammar 并接受来自潜在不可信方请求的系统都实施适当的缓存大小限制。
    3. 有关限制缓存大小的指导，请参阅 https://github.com/mlc-ai/xgrammar/pull/243 中实现的修复。
rule: version > "0" && version < "0.1.18"
references:
  - https://github.com/mlc-ai/xgrammar/security/advisories/GHSA-389x-67px-mjg3
  - https://nvd.nist.gov/vuln/detail/CVE-2025-32381
  - https://github.com/mlc-ai/xgrammar/pull/243
  - https://github.com/vllm-project/vllm/pull/16283
  - https://github.com/mlc-ai/xgrammar