info:
  name: langflow
  cve: CVE-2025-57760
  summary: Langflow 存在权限提升漏洞，在认证用户获得 RCE 后可通过 CLI 创建超级用户。
  details: |
    Langflow 容器中存在一个权限提升漏洞。一个拥有远程代码执行 (RCE) 访问权限的认证用户可以调用内部 CLI 命令 `langflow superuser` 来创建一个新的管理用户。即使该用户最初是通过 UI 作为普通（非管理员）账户注册的，这也会授予其完整的超级用户访问权限。这绕过了前端角色强制和后端用户完整性检查，导致 Langflow 应用程序被完全攻陷。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  severity: HIGH
  security_advise: |
    1. 将 Langflow 升级到 1.5.0 以上版本。
    2. 实施严格的访问控制，以防止未经授权执行内部 CLI 命令。
    3. 确保 `langflow superuser` 命令检查现有超级用户，并防止在没有适当授权的情况下创建新超级用户。
    4. 审查并强化 `/api/v1/validate/code` 端点，以防止 RCE 漏洞。
rule: version > "0" && version <= "1.5.0"
references:
  - https://github.com/langflow-ai/langflow/security/advisories/GHSA-4gv9-mp8m-592r
  - https://github.com/langflow-ai/langflow