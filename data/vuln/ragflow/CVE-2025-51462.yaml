info:
  name: ragflow
  cve: CVE-2025-51462
  summary: RAGFlow 中存储型跨站脚本 (XSS) 漏洞。
  details: |
    RAGFlow 0.17.2 版本的 `api.apps.dialog_app.set_dialog` 中存在一个存储型跨站脚本 (XSS) 漏洞。远程攻击者可以通过向助手问候语字段提供特制输入来执行任意 JavaScript。此输入未经净化存储，并随后使用带有 `rehype-raw` 的 markdown 组件进行渲染，从而导致恶意脚本的执行。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  severity: MEDIUM
  security_advise: |
    1. 将 RAGFlow 升级到已修复此漏洞的版本（请参阅提供的参考资料以获取具体的补丁版本）。
    2. 对所有用户提供的数据实施强大的输入净化，尤其是在助手问候语等字段中。
    3. 配置 markdown 渲染组件以禁止原始 HTML 或脚本执行。
  references:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-51462
    - https://github.com/infiniflow/ragflow/pull/7250
    - https://github.com/infiniflow/ragflow
    - https://www.gecko.security/blog/cve-2025-51462
rule: version == "0.17.2"