info:
  name: clickhouse
  cve: CVE-2025-1520
  summary: PostHog 插件服务器 SQL 注入漏洞允许远程代码执行。
  details: |
    该漏洞存在于 PostHog ClickHouse 表函数中，原因是 SQL 解析器未能正确验证用户提供的字符串。此缺陷允许具有身份验证的网络相邻攻击者，通过构造恶意 SQL 查询，在数据库账户的上下文中执行任意代码。
  cvss: CVSS:3.0/AV:A/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
  severity: HIGH
  security_advise: |
    1. 将 PostHog 插件服务器升级到 1.10.7 以上版本。
    2. 应用提交中提供的补丁：`6e8f035f9acd339c5ba87ba6ea40fc1ab3053d42`。
    3. 对所有用于 SQL 查询的用户提供的字符串实施严格的输入验证。
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-1520
  - https://github.com/PostHog/posthog/commit/6e8f035f9acd339c5ba87ba6ea40fc1ab3053d42
  - https://github.com/PostHog/plugin-server
  - https://www.zerodayinitiative.com/advisories/ZDI-25-099
rule: version > "0" && version <= "1.10.7"