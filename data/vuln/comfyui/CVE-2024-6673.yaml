info:
  name: comfyui
  cve: CVE-2024-6673
  summary: lollms-webui 的 `install_comfyui` 端点中存在跨站请求伪造 (CSRF) 漏洞。
  details: |
    在 parisneo/lollms-webui 仓库的 `lollms_comfyui.py` 文件中，版本 v9.9 到最新版本，`install_comfyui` 端点存在跨站请求伪造 (CSRF) 漏洞。该端点使用 GET 方法，且不需要客户端 ID，这使得攻击者可以诱骗受害者安装 ComfyUI。如果受害者的设备容量不足，这可能导致系统崩溃。
  cvss: CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:L
  severity: MEDIUM
  security_advise: |
    1. 将 lollms-webui 升级到在提交 `c1bb1ad19752aa7541675b398495eaf98fd589f1` 之后打补丁的版本。
    2. 确保敏感操作需要正确的 CSRF 令牌或使用带有适当验证的 POST 请求。
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-6673
  - https://github.com/parisneo/lollms-webui/commit/c1bb1ad19752aa7541675b398495eaf98fd589f1
  - https://huntr.com/bounties/a38f9a7d-b357-427d-adac-f9654d8c0e3c
rule: version >= "9.9"