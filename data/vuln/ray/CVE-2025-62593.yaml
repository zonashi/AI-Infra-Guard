info:
  name: ray
  cve: CVE-2025-62593
  summary: Ray 易受通过 DNS 重绑定攻击，利用 Safari 和 Firefox 浏览器导致的关键远程代码执行 (RCE) 漏洞。
  details: |
    使用 Ray 作为开发工具的开发者可能会通过一个关键的 RCE 漏洞受到攻击，该漏洞可通过 Firefox 和 Safari 浏览器利用。这是由于对基于浏览器的攻击防护不足，因为当前的防御机制使用了以“Mozilla”字符串开头的 `User-Agent` 标头作为防御，但这种机制不足，因为 fetch 规范允许修改 `User-Agent` 标头。结合针对浏览器的 DNS 重绑定攻击，此漏洞可针对运行 Ray 的开发者进行利用，当他们无意中访问恶意网站或遇到恶意广告时。
  cvss: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H
  severity: CRITICAL
  security_advise: |
    1. 升级到 Ray 2.52.0 或更高版本。
    2. 启用 Ray 中默认禁用的身份验证功能 (https://docs.ray.io/en/latest/ray-security/token-auth.html)。
  references:
    - https://github.com/ray-project/ray/security/advisories/GHSA-q279-jhrf-cc6v
    - https://nvd.nist.gov/vuln/detail/CVE-2025-62593
    - https://github.com/nccgroup/singularity/pull/68
    - https://github.com/ray-project/ray/commit/70e7c72780bdec075dba6cad1afe0832772bfe09
    - https://docs.ray.io/en/releases-2.51.1/ray-security/index.html
    - https://en.wikipedia.org/wiki/Malvertising
    - https://github.com/ray-project/ray
    - https://github.com/ray-project/ray/blob/e7889ae542bf0188610bc8b06d274cbf53790cbd/python/ray/dashboard/http_server_head.py#L184-L196
    - https://github.com/ray-project/ray/blob/f39a860436dca3ed5b9dfae84bd867ac10c84dc6/python/ray/dashboard/optional_utils.py#L129-L155
rule: version > "0" && version < "2.52.0"