info:
  name: pyload-ng
  cve: CVE-2025-54140
  summary: pyLoad 在 json/upload 端点存在路径遍历漏洞，允许任意文件写入。
  details: |
    `pyLoad` 的 `/json/upload` 端点存在经过身份验证的路径遍历漏洞。
    通过操纵上传文件的文件名，攻击者可以遍历出预期的上传目录，
    从而允许他们将任意文件写入到 pyLoad 进程可访问的系统上的任何位置。
    这可能导致远程代码执行 (RCE)、本地权限提升、系统范围的损害以及持久性/后门。
    该漏洞源于 `src/pyload/webui/app/blueprints/json_blueprint.py` 中 `file.filename` 缺乏净化或验证，
    允许通过 `../../` 序列进行遍历。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
  severity: HIGH
  security_advise: |
    1. 升级到 pyload-ng 0.5.0b3.dev90 或更高版本。
    2. 对 `/json/upload` 端点中的文件名实施严格的输入验证和净化，以防止路径遍历序列。
    3. 确保保存上传文件的目录得到妥善保护，并具有最小的写入权限。
rule: version < "0.5.0b3.dev90"
references:
  - https://github.com/pyload/pyload/security/advisories/GHSA-xqpg-92fq-grfg
  - https://nvd.nist.gov/vuln/detail/CVE-2025-54140
  - https://github.com/pyload/pyload/commit/fc4b136e9c4e7dcbb8e467ae802cb2c3f70a71b0
  - https://github.com/pyload/pyload
  - https://github.com/pyload/pyload/blob/df094db67ec6e25294a9ac0ddb4375fd7fb9ba00/src/pyload/webui/app/blueprints/json_blueprint.py#L109