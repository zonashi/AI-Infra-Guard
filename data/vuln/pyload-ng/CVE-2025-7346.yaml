info:
  name: pyload-ng
  cve: CVE-2025-7346
  summary: pyLoad 易受绕过本地主机限制的攻击，从而能够创建任意软件包。
  details: |
    任何未经身份验证的攻击者都可以绕过应用程序施加的本地主机限制，并利用此限制创建任意软件包。这是通过将 `Host` 标头更改为 `127.0.0.1:9666` 的值来完成的。这允许未经身份验证的用户执行仅应由经过身份验证的用户执行的操作。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
  severity: HIGH
  security_advise: |
    1. 升级到 pyLoad-ng 的修补版本。
    2. 实施更强大的主机标头验证，以防止绕过。
    3. 确保敏感操作仅对经过身份验证的用户可用，无论 `Host` 标头如何。
rule: version > "0" && version <= "0.5.0b3.dev88"
references:
  - https://github.com/pyload/pyload/security/advisories/GHSA-x698-5hjm-w2m5
  - https://github.com/pyload/pyload/commit/f4e2d12416ba2dfac7b036d5c8d6dab5461b9840
  - https://github.com/pyload/pyload
  - https://github.com/pyload/pyload/blob/4159a1191ec4fe6d927e57a9c4bb8f54e16c381d/src/pyload/webui/app/blueprints/cnl_blueprint.py#L21-L36
  - https://github.com/pyload/pyload/blob/4159a1191ec4fe6d927e57a9c4bb8f54e16c381d/src/pyload/webui/app/blueprints/cnl_blueprint.py#L56-L58C11