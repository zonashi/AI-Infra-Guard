info:
  name: pyload-ng
  cve: CVE-2025-55156
  summary: PyLoad 存在 SQL 注入漏洞，通过 /json/add_package API 端点的 add_links 参数。
  details: |
    `/json/add_package` API 端点中的 `add_links` 参数易受 SQL 注入攻击。
    此漏洞产生的原因是，从用户提供的数据构造的 `statuses` 变量被直接拼接到 SQL 查询中，
    而没有进行适当的清理或参数化。这使得攻击者能够注入恶意 SQL 代码，
    可能导致数据库中敏感数据泄露、修改或删除。
  cvss: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:H/SC:N/SI:N/SA:N/E:P
  severity: HIGH
  security_advise: |
    1. 将 PyLoad 升级到版本 `0.5.0b3.dev91` 或更高版本。
    2. 确保所有 SQL 查询都使用参数化语句，以防止用户输入直接拼接。
    3. 在数据库操作中使用用户提供的数据之前，对其进行审查和清理。
rule: version > "0" && version < "0.5.0b3.dev91"
references:
  - https://github.com/pyload/pyload/security/advisories/GHSA-pwh4-6r3m-j2rf
  - https://nvd.nist.gov/vuln/detail/CVE-2025-55156
  - https://github.com/pyload/pyload/commit/134edcdf6e2a10c393743c254da3d90b74258f
  - https://github.com/pyload/pyload
  - https://github.com/pyload/pyload/blob/develop/src/pyload/core/database/file_database.py#L271