info:
  name: langchain
  cve: CVE-2025-6984
  summary: Langchain Community 因 EverNoteLoader 组件中不安全的 XML 解析而容易受到 XML 外部实体 (XXE) 攻击。
  details: |
    `langchain-ai/langchain` 项目，特别是 `EverNoteLoader` 组件，容易受到 XML 外部实体 (XXE) 攻击。此漏洞是由于在使用 `etree.iterparse()` 时未禁用外部实体引用而引起的，这可能导致敏感信息泄露。攻击者可以通过精心构造恶意 XML 有效载荷来利用此漏洞，该有效载荷引用本地文件，从而可能暴露敏感数据，例如 `/etc/passwd`。
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. 将 `langchain-community` 升级到版本 `0.3.27` 或更高版本。
    2. 确保 XML 解析器配置为禁用外部实体解析。
rule: version > "0" && version < "0.3.27"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-6984
  - https://github.com/langchain-ai/langchain-community/commit/e842452108089524e22c3a2ced851c021884556f
  - https://github.com/langchain-ai/langchain-community
  - https://github.com/langchain-ai/langchain/blob/d79b5813a0b3b243c612b77013768995e46c4337/libs/langchain/langchain/document_loaders/evernote.py#L1-L23
  - https://huntr.com/bounties/a6b521cf-258c-41c0-9edb-d8ef976abb2a