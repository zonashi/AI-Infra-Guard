info:
  name: langchain
  cve: CVE-2025-64104
  summary: LangGraph 的 SQLite 存储因键参数化不当而容易受到 SQL 注入攻击。
  details: |
    LangGraph 的 SQLite 存储实现存在 SQL 注入漏洞。该问题源于将 JSON 路径键直接字符串连接到 SQL 查询中，而没有进行适当的清理，从而允许攻击者注入任意 SQL 并绕过访问控制。这会影响直接使用 `checkpoint-sqlite` 存储并使用来自不受信任或用户提供的输入的键构建 `filter` 参数的开发人员或项目。
  cvss: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N
  severity: HIGH
  security_advise: |
    1. 将 `langgraph-checkpoint-sqlite` 包升级到 `2.0.11` 或更高版本。
    2. 确保传递给 `SqliteStore` 的过滤键是静态的、经过验证的，或者如果使用用户提供的输入，则将其列入白名单。
    3. 避免在没有适当清理的情况下直接使用不受信任或用户提供的输入作为过滤键。
rule: version > "0" && version < "2.0.11"
references:
  - https://github.com/langchain-ai/langgraph/security/advisories/GHSA-7p73-8jqx-23r8
  - https://nvd.nist.gov/vuln/detail/CVE-2025-64104
  - https://github.com/langchain-ai/langgraph/commit/bc9d45b476101e441cb1cc602dea03eb29232de4
  - https://github.com/langchain-ai/langgraph