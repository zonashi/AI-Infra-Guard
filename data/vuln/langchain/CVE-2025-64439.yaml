info:
  name: langchain
  cve: CVE-2025-64439
  summary: LangGraph Checkpoint 的 JsonPlusSerializer 在 "json" 模式下受 RCE 漏洞影响。
  details: |
    在 `langgraph-checkpoint` 版本 `3.0` 之前，LangGraph 的 `JsonPlusSerializer`（用作所有检查点的默认序列化协议）在反序列化以 `"json"` 序列化模式保存的有效载荷时，存在远程代码执行 (RCE) 漏洞。如果攻击者可以诱导您的应用程序持久化以此模式序列化的有效载荷，他们也可能发送恶意内容，在反序列化期间执行任意 Python 代码。
  cvss: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:N/VI:H/VA:H/SC:H/SI:H/SA:H
  severity: HIGH
  security_advise: |
    1. 立即升级到 `langgraph-checkpoint==3.0.0`。
    2. 如果部署在 `langgraph-api` 中，请更新到版本 `0.5` 或更高版本。
rule: version < "3.0.0"
references:
  - https://github.com/langchain-ai/langgraph/security/advisories/GHSA-wwqv-p2pp-99h5
  - https://nvd.nist.gov/vuln/detail/CVE-2025-64439
  - https://github.com/langchain-ai/langgraph/commit/c5744f583b11745cd406f3059903e17bbcdcc8ac
  - https://github.com/langchain-ai/langgraph
  - https://github.com/langchain-ai/langgraph/blob/c5744f583b11745cd406f3059903e17bbcdcc8ac/libs/checkpoint/langgraph/checkpoint/serde/jsonplus.py
  - https://github.com/langchain-ai/langgraph/releases/tag/checkpoint%3D%3D3.0.0