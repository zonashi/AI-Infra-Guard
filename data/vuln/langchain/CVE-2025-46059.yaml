info:
  name: langchain
  cve: CVE-2025-46059
  summary: Langchain 的 GmailToolkit 中存在间接提示注入漏洞。
  details: |
    langchain-ai v0.3.51 被发现在其 GmailToolkit 组件中存在间接提示注入漏洞。
    此缺陷允许攻击者通过精心构造的电子邮件消息执行任意代码并危及应用程序。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. 升级到 langchain-ai 的已修补版本（如果可用）。
    2. 对 GmailToolkit 处理的所有电子邮件内容实施严格的输入验证和净化。
    3. 审查并限制 Langchain 应用程序的权限，以最大程度地减少潜在危害的影响。
    4. 参考 Langchain 官方安全文档以获取最佳实践。
rule: version < "0.3.51"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-46059
  - https://github.com/langchain-ai/langchain-community/issues/217#issuecomment-3144824471
  - https://github.com/langchain-ai/langchain/issues/30833
  - https://github.com/Jr61-star/CVEs/blob/main/CVE-2025-46059.md
  - https://python.langchain.com/docs/security