info:
  name: langchain
  cve: CVE-2025-58177
  summary: n8n LangChain 聊天触发器节点中通过 initialMessages 参数存在存储型 XSS。
  details: |
    n8n 的 `@n8n/n8n-nodes-langchain.chatTrigger` 节点中存在一个存储型跨站脚本 (XSS) 漏洞。
    如果授权用户在 `initialMessages` 字段中配置恶意 JavaScript 并启用公共访问，
    则当任何访问生成的公共聊天 URL 的用户在浏览器中执行该脚本时，
    这可能导致网络钓鱼、cookie 窃取或其他敏感数据泄露。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:N/A:N
  severity: MEDIUM
  security_advise: |
    1. 升级到 n8n 1.107.0 或更高版本。
    2. 作为权宜之计，禁用 `n8n-nodes-langchain.chatTrigger` 节点。
  references:
    - https://github.com/n8n-io/n8n/security/advisories/GHSA-mvh4-2cm2-6hpg
    - https://nvd.nist.gov/vuln/detail/CVE-2025-58177
    - https://github.com/n8n-io/n8n/pull/18148
    - https://github.com/n8n-io/n8n/commit/d4ef191be0b39b65efa68559a3b8d5dad2e102b2
    - https://docs.n8n.io/hosting/securing/blocking-nodes
    - https://github.com/n8n-io/n8n
rule: version >= "1.24.0" && version < "1.107.0"