info:
  name: langchain
  cve: CVE-2025-8709
  summary: LangGraph 的 SQLite 存储实现存在 SQL 注入漏洞。
  details: |
    langchain-ai/langgraph 存储库中存在 SQL 注入漏洞，具体位于 LangGraph 的 SQLite 存储实现中。受影响的版本是 langgraph-checkpoint-sqlite 2.0.10。该漏洞产生于对过滤操作符（$eq, $ne, $gt, $lt, $gte, $lte）的不当处理，其中直接使用字符串拼接而没有进行适当的参数化。这使得攻击者可以注入任意 SQL，导致未经授权访问所有文档、敏感字段（如密码和 API 密钥）的数据泄露，以及完全绕过应用程序级别的安全过滤器。
  cvss: CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N
  severity: HIGH
  security_advise: |
    1. 将 `langgraph-checkpoint-sqlite` 升级到 2.0.11 或更高版本。
    2. 确保所有数据库查询都使用参数化语句，以防止 SQL 注入。
rule: version > "0" && version < "2.0.11"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-8709
  - https://github.com/langchain-ai/langgraph/pull/5666
  - https://github.com/langchain-ai/langgraph/commit/bc9d45b476101e441cb1cc602dea03eb29232de4
  - https://github.com/langchain-ai/langgraph
  - https://github.com/langchain-ai/langgraph/releases/tag/checkpointsqlite%3D%3D2.0.11
  - https://huntr.com/bounties/9793f4b3-76f8-44a4-989f-49a2177ee118